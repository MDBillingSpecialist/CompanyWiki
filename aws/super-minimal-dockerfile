FROM node:18-alpine

WORKDIR /app

# Copy the server file
COPY ./aws/super-minimal-server.js .

# Expose port explicitly
EXPOSE 3000

# Environment variables
ENV NODE_ENV=production
ENV PORT=3000

# Print debug information during build
RUN echo "Node version: $(node -v)" && \
    echo "NPM version: $(npm -v)" && \
    ls -la

# Start server with explicit port binding
CMD ["node", "super-minimal-server.js"]